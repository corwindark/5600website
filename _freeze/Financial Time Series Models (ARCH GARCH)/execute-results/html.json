{
  "hash": "ee4b50c1be966c52815fd6e6b3924c54",
  "result": {
    "markdown": "---\ntitle: \"Financial Time Series Models (ARCH GARCH)\"\n---\n\n\n\n\n<h2> Introduction </h2>\n\nOn this page, I will look to see whether ARCH and GARCH models may be a good fit for the change in intraday range of popular stock market indices. While these models would usually be fitted on the returns of financial intstruments, the day over day change in intraday percent range also exhibits volatility clustering, and intraday range is the exact subject of my project. This means that modelling these time series successfully would be complementary with the other models I have tried to fit, and I am eager to investigate whether these methods will work well at answering my research questions. I will look to fit 3 models: 1 each for the daily range of SPY, QQQ, and IWM.\n\n\n\n\n<h2> Stationarity and Volatility </h2>\n\nLoad packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(forecast)\nlibrary(quantmod)\n```\n:::\n\n\n\n\nRead in data\n\n::: {.cell}\n\n```{.r .cell-code}\nspyIn <- quantmod::getSymbols(\"SPY\", from = as.Date(\"2021/01/01\"), to = as.Date(\"2023/09/30\"), periodicity = \"daily\", src = \"yahoo\", auto.assign = FALSE)\nqqqIn <- quantmod::getSymbols(\"QQQ\", from = as.Date(\"2021/01/01\"), to = as.Date(\"2023/09/30\"), periodicity = \"daily\", src = \"yahoo\", auto.assign = FALSE)\niwmIn <- quantmod::getSymbols(\"IWM\", from = as.Date(\"2021/01/01\"), to = as.Date(\"2023/09/30\"), periodicity = \"daily\", src = \"yahoo\", auto.assign = FALSE)\n\n\nspyIn$spyRange <- (spyIn$SPY.High - spyIn$SPY.Low)/ spyIn$SPY.Open\nqqqIn$qqqRange <- (qqqIn$QQQ.High - qqqIn$QQQ.Low)/ qqqIn$QQQ.Open\niwmIn$iwmRange <- (iwmIn$IWM.High - iwmIn$IWM.Low)/ iwmIn$IWM.Open\n```\n:::\n\n\n\nPlotting the daily ranges:\n\nSPY\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(spyIn$spyRange)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThe SPY data certainly appears to have clustered volatility, as there are large swings in close proximity to eachother. But it also has noticeable trend, with the intraday ranges being higher during the middle of the time series before dropping down again towards the end. To combat this, let's look at the differenced series:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(spyIn$spyRange %>% diff())\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nNow, we see a plot that looks very similar to the daily returns of a stock and promising for ARCH/GARCH modeling, which means it is stationary but has clustered volatility. To adjust for this, we can fit an ARIMA model on the SPY ranges, and then fit a GARCH model on the residuals, which will come from differenced data that is now stationary.\n\nRepeating the process for QQQ:\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(qqqIn$qqqRange)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nOnce again we see clear non-stationarity in the data, so let's look at the differenced values:\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(qqqIn$qqqRange %>% diff())\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nSimilar to the SPY data, the time series is now stationary, although there is heteroskedasticity. So we might expect to model QQQ and SPY similarly, with an ARIMA + ARCH/GARCH model.\n\n\nLet's check IWM:\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(iwmIn$iwmRange)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nIWM's intraday range looks slightly more stationary than the other 2 time series, and also has more extreme changes in volatility over time. However, we can still see somewhat of a trend, such that a moving average would be obviously nonstationary, so once again we difference the series.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(iwmIn$iwmRange %>% diff())\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nWhile the variance looked elevated in the non-differenced plot, it is actually less hesteroskedastic in the differenced plot. This suggests IWM may not have as much autocorrelation in the variance as the other two indices. An ARIMA model alone might suffice here.\n\n\n<h2>  Look at past arima model for the data (fit here and copy to that tab later) </h2>\n\nNow, let's gather ARIMA models for the intraday range. First we declare the helper function\n\n::: {.cell}\n\n```{.r .cell-code}\narimaResults <- function(data) {\n    \n    i=1\n    temp= data.frame()\n    ls=matrix(rep(NA,6*100),nrow=100) # roughly nrow = 3x4x2\n\n    for (p in 1:6)# p=1,2,3 : 3\n    {\n        for(q in 1:6)# q=1,2,3,4 :4\n        {\n            for(d in 1:2) {\n                \n                if(p-1+d - 1+q-1<=8) #usual threshold\n                {\n                    \n                    model<- Arima(data,order=c(p-1,d-1,q-1),include.drift=FALSE) \n                    ls[i,]= c(p-1,d-1,q-1,model$aic,model$bic,model$aicc)\n                    i=i+1\n                    #print(i)\n                    \n                }\n\n            }\n                \n        }\n    }\n\n    temp= as.data.frame(ls)\n    names(temp)= c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\n    return(temp[which.min(temp$AIC),])\n    #return(temp)\n}\n```\n:::\n\n\n\n\nNow, let's find good-fitting models starting with SPY:\n\n::: {.cell}\n\n```{.r .cell-code}\narimaResults(spyIn$spyRange)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   p d q       AIC       BIC      AICc\n43 3 0 3 -5139.956 -5103.662 -5139.744\n```\n:::\n:::\n\n\nThe best model returned by the function is ARMA(3,0,3). It is surprising that the models which differenced the data didn't perform better, but I manually reviewed those options and they all had worse AIC and BIC scores.\n\nFor QQQ:\n\n::: {.cell}\n\n```{.r .cell-code}\narimaResults(qqqIn$qqqRange)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   p d q      AIC       BIC      AICc\n15 1 0 1 -4814.81 -4796.663 -4814.751\n```\n:::\n:::\n\n\nFor QQQ, the model with the lowest AIC score was ARMA(1,0,1). Once again I expected a differenced model to perform better, but I will continue with the residuals from this model.\n\nFor IWM:\n\n::: {.cell}\n\n```{.r .cell-code}\narimaResults(iwmIn$iwmRange)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   p d q       AIC       BIC      AICc\n56 4 0 4 -4857.373 -4812.006 -4857.049\n```\n:::\n:::\n\n\nFitting the pattern of the best models for the financial instruments being of the form ARMA(N, 0, N), the model with the lowest AIC for IWM was ARMA(4,0,4).\n\n\n\n<h2> Reviewing Residuals to Identify ARCH/GARCH Models </h2>\n\nNow, lets look at the residuals of all of these models, to identify clustering and see if we need to fit ARCH/GARCH models on the residuals.\n\nDeclaring the models\n\n::: {.cell}\n\n```{.r .cell-code}\nspyARMA <- arima(spyIn$spyRange, order = c(3,0,3))\nqqqARMA <- arima(qqqIn$qqqRange, order = c(1,0,1))\niwmARMA <- arima(iwmIn$iwmRange, order = c(4,0,4))\n```\n:::\n\n\n\nSPY range residuals:\n\n::: {.cell}\n\n```{.r .cell-code}\ncheckresiduals(spyARMA)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tLjung-Box test\n\ndata:  Residuals from ARIMA(3,0,3) with non-zero mean\nQ* = 5.2511, df = 4, p-value = 0.2625\n\nModel df: 6.   Total lags used: 10\n```\n:::\n:::\n\n\nThe residuals show definite clustering around timestamps 260 and 450, which suggests a ARCH/GARCH model will be a good fit. Now lets look at ACF and PACF plots of the residuals and squared residuals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacf(spyARMA$residuals)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(spyARMA$residuals)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(spyARMA$residuals^2)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-15-3.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(spyARMA$residuals^2)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-15-4.png){width=672}\n:::\n\n```{.r .cell-code}\n#install.packages('FinTS')\nlibrary(FinTS)\nArchTest(spyIn$spyRange)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  spyIn$spyRange\nChi-squared = 204.01, df = 12, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n#ArchTest(spyARMA$residuals)\n```\n:::\n\n\nBased on the ACF and PACF plots, it seems like an ARCH model of (1) might be the best fit for SPY residual data. An ARCH test of the original range data confirms that there is an ARCH effect in the dataset.\n\n\nQQQ Residuals:\n\n::: {.cell}\n\n```{.r .cell-code}\nacf(qqqARMA$residuals)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(qqqARMA$residuals)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(qqqARMA$residuals^2)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(qqqARMA$residuals^2)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-16-4.png){width=672}\n:::\n\n```{.r .cell-code}\n#install.packages('FinTS')\nlibrary(FinTS)\nArchTest(qqqIn$qqqRange)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  qqqIn$qqqRange\nChi-squared = 173.7, df = 12, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nArchTest(qqqARMA$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  qqqARMA$residuals\nChi-squared = 17.618, df = 12, p-value = 0.1278\n```\n:::\n:::\n\n\nThe QQQ residuals suggest GARCH values up to (1,3). The squared residuals suggest more similar to a ARCH(1) model. ARCH tests of the original range data confirm an ARCH effect.\n\n\n\nIWM Residuals:\n\n::: {.cell}\n\n```{.r .cell-code}\nacf(iwmARMA$residuals)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(iwmARMA$residuals)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n\n```{.r .cell-code}\nacf(iwmARMA$residuals^2)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-17-3.png){width=672}\n:::\n\n```{.r .cell-code}\npacf(iwmARMA$residuals^2)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-17-4.png){width=672}\n:::\n\n```{.r .cell-code}\n#install.packages('FinTS')\nlibrary(FinTS)\nArchTest(iwmIn$iwmRange)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  iwmIn$iwmRange\nChi-squared = 174.39, df = 12, p-value < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nArchTest(iwmARMA$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tARCH LM-test; Null hypothesis: no ARCH effects\n\ndata:  iwmARMA$residuals\nChi-squared = 28.872, df = 12, p-value = 0.004116\n```\n:::\n:::\n\n\nThe IWM residuals look similar to the spy residuals, but suggest an ARCH (1) model. The squared residuals suggest GARCH(1,1).\n\n<h2> Finding and evaluating ARCH and GARCH Fits </h2>\n\nLet's start by declaring a GARCH helper function that checks possible values:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tseries)\ngarchResults <- function(data) {\n    model <- list() ## set counter\n    cc <- 1\n    for (p in 1:7) {\n        for (q in 1:7) {\n            if(p + q < 8) {\n                model[[cc]] <- garch(data,order=c(q-1,p),trace=F)\n                cc <- cc + 1\n            }\n        }\n    } \n\n    ## get AIC values for model evaluation\n    GARCH_AIC <- sapply(model, AIC) ## model with lowest AIC is the best\n    #which(GARCH_AIC == min(GARCH_AIC))\n    ## [1] 24\n    model[[which(GARCH_AIC == min(GARCH_AIC))]]\n}\n```\n:::\n\n\n\n<h3> SPY GARCH Model Fitting, Diagnostics, and Equation </h3>\nLet's check our ARCH(1) model hypothesis for SPY:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vars)\nlibrary(fGarch)\n\nspyMod <- garchResults(spyARMA$residuals)\nsummary(spyMod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\ngarch(x = data, order = c(q - 1, p), trace = F)\n\nModel:\nGARCH(4,1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.9251 -0.6944 -0.1773  0.4743  5.7716 \n\nCoefficient(s):\n    Estimate  Std. Error  t value Pr(>|t|)    \na0 1.295e-06   5.529e-07    2.342   0.0192 *  \na1 2.677e-01   4.417e-02    6.060 1.36e-09 ***\nb1 2.309e-01   9.399e-02    2.457   0.0140 *  \nb2 3.670e-09   1.336e-01    0.000   1.0000    \nb3 8.880e-02   1.380e-01    0.643   0.5199    \nb4 4.160e-01   9.804e-02    4.244 2.20e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDiagnostic Tests:\n\tJarque Bera Test\n\ndata:  Residuals\nX-squared = 692.91, df = 2, p-value < 2.2e-16\n\n\n\tBox-Ljung test\n\ndata:  Squared.Residuals\nX-squared = 0.46517, df = 1, p-value = 0.4952\n```\n:::\n\n```{.r .cell-code}\n#checkresiduals(spyARMA)\ncheckresiduals(spyMod)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tLjung-Box test\n\ndata:  Residuals\nQ* = 2.669, df = 10, p-value = 0.9882\n\nModel df: 0.   Total lags used: 10\n```\n:::\n:::\n\n\nThe automatic function returns a surprise: The GARCH model with the lowest AIC is acutally GARCH(4,1). The diagnostics for this model are also promising, the 4th and 1st lag variance are highly significant (p < 0.05), as is the 1st residual error. The Box-Ljung test is decidedly above the threshold at which we can reject the idea that there is no autocorrelation in the residuals (p = 0.495) which is another encouraging sign for the model fit. This suggests that the model has explained most of the signal in the data, with little correlation left in the residuals. It also shows that the results have improved from the ARMA(3,0,3) model alone, which had a Ljung-Box test result of 0.26, which suggests less correlation is left in the residuals after fitting a GARCH(4,1) model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarchFit(formula = ~arma(3,3) + garch(4,1), data = spyIn$spyRange, trace = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTitle:\n GARCH Modelling \n\nCall:\n garchFit(formula = ~arma(3, 3) + garch(4, 1), data = spyIn$spyRange, \n    trace = FALSE) \n\nMean and Variance Equation:\n data ~ arma(3, 3) + garch(4, 1)\n<environment: 0x00000000387fa8e0>\n [data = spyIn$spyRange]\n\nConditional Distribution:\n norm \n\nCoefficient(s):\n         mu          ar1          ar2          ar3          ma1          ma2  \n 2.4917e-05   9.7804e-01   5.9471e-01  -5.7502e-01  -6.6483e-01  -5.8857e-01  \n        ma3        omega       alpha1       alpha2       alpha3       alpha4  \n 2.9376e-01   3.2859e-07   5.3270e-02   1.0000e-08   1.0000e-08   1.0000e-08  \n      beta1  \n 9.3784e-01  \n\nStd. Errors:\n based on Hessian \n\nError Analysis:\n         Estimate  Std. Error  t value Pr(>|t|)    \nmu      2.492e-05   3.759e-05    0.663 0.507405    \nar1     9.780e-01   1.474e-01    6.634 3.28e-11 ***\nar2     5.947e-01   1.858e-01    3.200 0.001374 ** \nar3    -5.750e-01   8.150e-02   -7.055 1.73e-12 ***\nma1    -6.648e-01   1.629e-01   -4.082 4.46e-05 ***\nma2    -5.886e-01   1.573e-01   -3.742 0.000182 ***\nma3     2.938e-01   8.403e-02    3.496 0.000473 ***\nomega   3.286e-07   2.829e-07    1.161 0.245454    \nalpha1  5.327e-02   4.160e-02    1.281 0.200369    \nalpha2  1.000e-08   4.400e-02    0.000 1.000000    \nalpha3  1.000e-08   1.060e-01    0.000 1.000000    \nalpha4  1.000e-08   8.994e-02    0.000 1.000000    \nbeta1   9.378e-01   2.959e-02   31.699  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nLog Likelihood:\n 2619.748    normalized:  3.796736 \n\nDescription:\n Fri Dec 01 22:44:15 2023 by user: corwi \n```\n:::\n:::\n\n\nThe final evaluation of all the parameters together, however, suggests that the GARCH model should be (0,1). SO I will write the final correct formula as:\n\nFinal formula is:\nRt = 0.000025 + 0.978 * R(t-1) + 0.595 * R(t-2) - 0.575 * R(t-3) - 0.665 * W(t-1) - 0.589 * W(t-2) + 0.294 * W(t-3) +  At\n\nAt = Sigma(t) * Epsilon(t)\n\nSigma(t) ^ 2 =   0.00000033 +  0.94 * Sigma(t-1)^2\n\n\n<h3> QQQ GARCH Model Fitting, Diagnostics, and Equation </h3>\n\n::: {.cell}\n\n```{.r .cell-code}\nqqqMod <- garchResults(qqqARMA$residuals)\nsummary(qqqMod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\ngarch(x = data, order = c(q - 1, p), trace = F)\n\nModel:\nGARCH(1,1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9569 -0.6967 -0.1981  0.4453  5.4864 \n\nCoefficient(s):\n    Estimate  Std. Error  t value Pr(>|t|)    \na0 3.515e-07   1.633e-07    2.152   0.0314 *  \na1 3.527e-02   5.331e-03    6.615 3.72e-11 ***\nb1 9.582e-01   6.218e-03  154.113  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDiagnostic Tests:\n\tJarque Bera Test\n\ndata:  Residuals\nX-squared = 591.42, df = 2, p-value < 2.2e-16\n\n\n\tBox-Ljung test\n\ndata:  Squared.Residuals\nX-squared = 0.070318, df = 1, p-value = 0.7909\n```\n:::\n\n```{.r .cell-code}\n#qqqMod\n\n#checkresiduals(qqqARMA)\n#checkresiduals(qqqMod)\n```\n:::\n\n\nThe GARCH model with the lowest AIC for the QQQ residuals is GARCH(1,1), which is within the range of the (1,3) we suspected, but still a different value than we anticipated. All of the terms in this model a significant at the p<0.05 level, both the residual error lag term and the lag variance term. In addition, the Ljung-Box test score improves from 0.1825 in the ARMA(1,0,1) model alone, to 0.51 in the GARCH model. This suggests the model has lowered the autocorrelation in the residuals.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarchFit(formula = ~arma(1,1) + garch(1,1), data = qqqIn$qqqRange, trace = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTitle:\n GARCH Modelling \n\nCall:\n garchFit(formula = ~arma(1, 1) + garch(1, 1), data = qqqIn$qqqRange, \n    trace = FALSE) \n\nMean and Variance Equation:\n data ~ arma(1, 1) + garch(1, 1)\n<environment: 0x000000003ae13dd0>\n [data = qqqIn$qqqRange]\n\nConditional Distribution:\n norm \n\nCoefficient(s):\n         mu          ar1          ma1        omega       alpha1        beta1  \n 6.1100e-04   9.6203e-01  -7.4073e-01   3.5130e-07   3.5178e-02   9.5819e-01  \n\nStd. Errors:\n based on Hessian \n\nError Analysis:\n         Estimate  Std. Error  t value Pr(>|t|)    \nmu      6.110e-04   2.413e-04    2.532   0.0113 *  \nar1     9.620e-01   1.488e-02   64.636  < 2e-16 ***\nma1    -7.407e-01   3.685e-02  -20.099  < 2e-16 ***\nomega   3.513e-07   2.017e-07    1.741   0.0816 .  \nalpha1  3.518e-02   7.556e-03    4.656 3.23e-06 ***\nbeta1   9.582e-01   7.993e-03  119.873  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nLog Likelihood:\n 2441.621    normalized:  3.538581 \n\nDescription:\n Fri Dec 01 22:44:15 2023 by user: corwi \n```\n:::\n:::\n\n\nFinal formula is:\nRt = 0.00061 + 0.962 * R(t-1) - 0.741 * W(t-1) +  At \n\nAt = Sigma(t) * Epsilon(t)\n\nSigma(t) ^ 2 =   0.00000035 +  .034 * a(t-1)^2  +  0.96 * Sigma(t-1)^2\n\n<h3> IWM GARCH Model Fitting, Diagnostics, and Equation </h3>\n\n::: {.cell}\n\n```{.r .cell-code}\niwmMod <- garchResults(iwmARMA$residuals)\nsummary(iwmMod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\ngarch(x = data, order = c(q - 1, p), trace = F)\n\nModel:\nGARCH(1,1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7824 -0.7249 -0.1962  0.4915  5.1795 \n\nCoefficient(s):\n    Estimate  Std. Error  t value Pr(>|t|)    \na0 2.153e-06   8.987e-07    2.395 0.016602 *  \na1 6.089e-02   1.693e-02    3.597 0.000322 ***\nb1 8.969e-01   2.903e-02   30.900  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDiagnostic Tests:\n\tJarque Bera Test\n\ndata:  Residuals\nX-squared = 338.27, df = 2, p-value < 2.2e-16\n\n\n\tBox-Ljung test\n\ndata:  Squared.Residuals\nX-squared = 8.6335e-05, df = 1, p-value = 0.9926\n```\n:::\n\n```{.r .cell-code}\n# checkresiduals(iwmARMA)\n\ncheckresiduals(iwmMod)\n```\n\n::: {.cell-output-display}\n![](Financial-Time-Series-Models--ARCH-GARCH-_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tLjung-Box test\n\ndata:  Residuals\nQ* = 4.2445, df = 10, p-value = 0.9356\n\nModel df: 0.   Total lags used: 10\n```\n:::\n:::\n\n\nFor IWM, the squared residuals showed a GARCH(1,1) fit, and this is also what the function returned as the model with the lowest AIC value. All of the terms were significant at the p < 0.01 threshold, and the Ljung-Box test returns 0.498, improving from 0.088 in the ARMA(4,0,4) model alone. This suggests the GARCH fit has done a very good job at removing autocorrelation from the resdiuals.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarchFit(formula = ~arma(4,2) + garch(1,1), data = iwmIn$iwmRange, trace = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTitle:\n GARCH Modelling \n\nCall:\n garchFit(formula = ~arma(4, 2) + garch(1, 1), data = iwmIn$iwmRange, \n    trace = FALSE) \n\nMean and Variance Equation:\n data ~ arma(4, 2) + garch(1, 1)\n<environment: 0x000000002da012f0>\n [data = iwmIn$iwmRange]\n\nConditional Distribution:\n norm \n\nCoefficient(s):\n         mu          ar1          ar2          ar3          ar4          ma1  \n 3.4855e-04   6.6410e-01   5.6820e-01  -1.7672e-01  -7.5180e-02  -3.9551e-01  \n        ma2        omega       alpha1        beta1  \n-4.7133e-01   1.7350e-06   5.8615e-02   9.0767e-01  \n\nStd. Errors:\n based on Hessian \n\nError Analysis:\n         Estimate  Std. Error  t value Pr(>|t|)    \nmu      3.485e-04   3.509e-04    0.993  0.32058    \nar1     6.641e-01   1.613e-01    4.118 3.83e-05 ***\nar2     5.682e-01   2.229e-01    2.549  0.01080 *  \nar3    -1.767e-01   5.433e-02   -3.253  0.00114 ** \nar4    -7.518e-02   6.747e-02   -1.114  0.26516    \nma1    -3.955e-01   1.592e-01   -2.484  0.01299 *  \nma2    -4.713e-01   1.791e-01   -2.631  0.00851 ** \nomega   1.735e-06   1.000e-06    1.734  0.08287 .  \nalpha1  5.861e-02   1.936e-02    3.027  0.00247 ** \nbeta1   9.077e-01   3.244e-02   27.979  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nLog Likelihood:\n 2457.18    normalized:  3.56113 \n\nDescription:\n Fri Dec 01 22:44:16 2023 by user: corwi \n```\n:::\n:::\n\n\nWhen pulling all of the variables together, the final model diagnostic suggests that the moving average terms 3 and 4 are not significant. As such, I will write the equation for the final selected model of ARMA(4,2) + GARCH(1,1):\n\n\nFinal formula is:\nRt = 0.00035 + 0.664 * R(t-1) + 0.568 * R(t-2) - 0.177 * R(t-3) - 0.075 * R(t-4) - 0.396 * W(t-1) - 0.471 * W(t-2) +  At\n\nAt = Sigma(t) * Epsilon(t)\n\nSigma(t) ^ 2 =   0.00000017 + .0586 * a(t-1)^2  +  0.908 * Sigma(t-1)^2",
    "supporting": [
      "Financial-Time-Series-Models--ARCH-GARCH-_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}